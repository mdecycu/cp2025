<!DOCTYPE html><html>
        <head>
        <title>cp2025</title>
        <meta charset="utf-8">
<meta property="head" content="H2">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/icomoon/style.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/magnific-popup.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/jquery-ui.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.carousel.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.theme.default.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap-datepicker.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/flaticon/font/flaticon.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/aos.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/style.css">
        <link rel="shortcut icon" href="./../cmsimde/static/favicons.png">
        
        <style type='text/css'>
            .site-section {
            background-color: #FFFF;
            padding: 40px 40px;
            }
            body > div > div.dropdown.open {
                display: block;
            }
        </style>
    
        <!-- <script src="./../cmsimde/static/jquery.js"></script> -->
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
        <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/normalize.min.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch_set.js"></script>
        <script src="tipuesearch_content.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/tipuesearch.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch.js"></script>
        <!-- for Wink3 客製化關閉 -->
        <!--
        <link rel="stylesheet" type="text/css" href="./../cmsimde/static/winkPlayer.css" />
        <script type="text/javascript" src="./../cmsimde/static/winkPlayer.js"></script>
        -->
        <script>
            /* original tipuesearch
            $(document).ready(function() {
                 $('#tipue_search_input').tipuesearch();
            });
            */
            // customed doSearch
            function doSearch() {
                $('#tipue_search_input').tipuesearch({
                    newWindow: true, 
                    minimumLength: 2,
                    wholeWords: false, // for search 中文
                });
            }
            $(document).ready(doSearch);
        </script>
        
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shCore.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushBash.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDiff.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJScript.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJava.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPython.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushSql.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushHaxe.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushXml.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPhp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPowerShell.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushLua.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushMojo.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushWbt.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCss.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCSharp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDart.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushRust.js"></script>
<link type="text/css" rel="stylesheet" href="./../cmsimde/static/syntaxhighlighter/css/shCoreDefault.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>
<!-- 暫時不用
<script src="./../cmsimde/static/fengari-web.js"></script>
<script type="text/javascript" src="./../cmsimde/static/Cango-13v08-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/CangoAxes-4v01-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/gearUtils-05.js"></script>
-->
<!-- for Brython 暫時不用
<script src="https://scrum-3.github.io/web/brython/brython.js"></script>
<script src="https://scrum-3.github.io/web/brython/brython_stdlib.js"></script>
-->
<style>
img.add_border {
    border: 3px solid blue;
}
</style>

</head>
<body>
<div class='container'><nav>
        
    <div class="site-wrap">

    <div class="site-mobile-menu">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div>
    
            <header class="site-navbar py-4 bg-white" role="banner">
              <div class="container">
                <div class="row align-items-center">
                <h1>cp2025 計算機程式</h1>
                <div class="pl-4">
                    <form>
                    <input type="text" placeholder="Search" name="q" id="tipue_search_input" pattern=".{2,}" title="At least 2 characters" required>
                    </form>
                </div>
                  <!-- <div class="col-11 col-xl-2">
                    <h1 class="mb-0 site-logo"><a href="index.html" class="text-black h2 mb-0">cp2025 計算機程式</a></h1> 
                  </div>
                  -->
                  <div class="col-12 col-md-10 d-none d-xl-block">
                    <nav class="site-navigation position-relative text-right" role="navigation">
    <ul class='site-menu js-clone-nav mr-auto d-none d-lg-block'>
                        <li class="active has-children"><a href="index.html">Home</a>
                        <ul class="dropdown">
                            <li><a href="sitemap.html">SMap</a></li>
                            <li><a href="./../reveal/index.html">reveal</a></li>
                            <li><a href="./../blog/index.html">blog</a></li>
                        </ul>
                      </li>
                     <li class='has-children'><a href='About.html'>About</a><ul class='dropdown'><li><a href='talk.html'>talk</a><li><a href='cs101.html'>cs101</a></li></ul><li class='has-children'><a href='Computer.html'>Computer</a><ul class='dropdown'><li class='has-children'><a href='llama.html'>llama</a><ul class='dropdown'><li><a href='nginx.html'>nginx</a></li></li></ul></ul><li class='has-children'><a href='Topics.html'>Topics</a><ul class='dropdown'><li class='has-children'><a href='Git.html'>Git</a><ul class='dropdown'><li><a href='Git_ex1.html'>Git_ex1</a><li><a href='Git_ex2.html'>Git_ex2</a></li></ul><li class='has-children'><a href='Python.html'>Python</a><ul class='dropdown'><li><a href='Python_ex1.html'>Python_ex1</a></li></ul><li class='has-children'><a href='Javascript.html'>Javascript</a><ul class='dropdown'><li><a href='HTML and CSS.html'>HTML and CSS</a></li></ul><li class='has-children'><a href='Project.html'>Project</a><ul class='dropdown'><li><a href='Waitress.html'>Waitress</a><li><a href='API.html'>API</a></li></ul><li class='has-children'><a href='V.html'>V</a><ul class='dropdown'><li><a href='learn_V.html'>learn_V</a></li></li></ul></ul><li class='has-children'><a href='Reeborg.html'>Reeborg</a><ul class='dropdown'><li><a href='ex1.html'>ex1</a></li></ul><li class='has-children'><a href='Brython.html'>Brython</a><ul class='dropdown'><li><a href='Brython_ex.html'>Brython_ex</a></li>
                      </ul>
                </nav>
              </div>
              <div class="d-inline-block d-xl-none ml-md-0 mr-auto py-3" style="position: relative; top: 3px;"><a href="#" class="site-menu-toggle js-menu-toggle text-black"><span class="icon-menu h3"></span></a></div>
              </div>

            </div>
          </div>
          
        </header>
    <div id="tipue_search_content">HTML and CSS << <a href='HTML and CSS.html'>Previous</a> <a href='Waitress.html'>Next</a> >> Waitress<br /><h1>Project</h1>
<p>請協助撰寫一個 Python Flask 網頁應用程式，前端表單需包含：<br/><br/>1. 一個「通關密碼」輸入欄位（用於驗證操作權限）<br/>2. 一個可填入使用者學號的欄位<br/>3. 一個用於設定新電子郵箱密碼的欄位<br/>4. 一個用於確認新電子郵箱密碼的欄位<br/><br/>使用者填寫上述欄位並提交表單後，系統應自動於 Google Workspace 平台建立對應的 email 帳號。</p>
<p><img caption="false" height="194" src="./../images/create_g_workspace_email_account.png" width="200"/></p>
<hr/>
<p>專案提案書：自動化 Google Workspace 帳號建立 Flask 應用程式<br/><br/>一、專案背景與目標<br/><br/>隨著組織規模成長，IT 部門需經常協助新員工建立 Google Workspace（G Suite）電子郵箱帳號。為提升效率、降低人為疏失及強化資安控管，本專案擬開發一個簡易 Web 應用程式，允許經授權者透過表單操作，自動於 Google Workspace 建立新 email 帳號。<br/><br/>二、需求說明</p>
<p>1. 前端表單功能：<br/>   - 通關密碼欄位（授權驗證）<br/>   - 可填入學號數字的欄位<br/>   - 電子郵箱密碼欄位<br/>   - 確認電子郵箱密碼欄位<br/>   - 按下送出後，系統自動於 Google Workspace 建立對應帳號<br/><br/>2. 安全性設計： <br/>   - 必須驗證通關密碼<br/>   - 僅允許授權人員操作 (例如: 只允許在特定網段進行操作)<br/>   - 檢查 email 格式與密碼強度<br/>   - 禁止重複帳號建立<br/>   - 僅允許數字做為帳號前綴<br/><br/>三、技術規劃<br/><br/>1. 技術需求<br/><br/>- Python 3.x<br/>- Flask — 前後端 Web 框架<br/>- google-api-python-client — Google Workspace API 操作<br/>- google-auth — 驗證與授權<br/>- Jinja2 — 表單模板（隨 Flask 內建）<br/>- pip — Python 套件管理<br/><br/>2. 開發與部署環境<br/><br/>- 建議部署於安全的內部伺服器或 Docker 容器<br/>- 僅開放組織內部網路存取<br/><br/>四、安裝說明<br/><br/>1. Python 套件安裝<br/><br/>請於專案目錄下執行：</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">pip install Flask google-api-python-client google-auth</pre>
<p>如需管理虛擬環境，建議搭配 venv 或 conda 使用。<br/><br/>2. Google Workspace API 準備<br/><br/>1. 建立 Google Cloud Platform 專案並啟用 Admin SDK API<br/>2. 建立 Service Account，下載憑證檔（JSON）<br/>3. 設定 Domain-wide Delegation（網域代理授權）<br/>4. 於 Google Workspace 管理控制台授權 API 的 OAuth2 Scope：<br/>   - https://www.googleapis.com/auth/admin.directory.user<br/><br/>五、各階段程式碼設計<br/><br/>1. 表單頁面（Flask/Jinja2）<br/><br/>python name=templates/form.html</p>
<pre class="brush:html;auto-links:false;toolbar:false" contenteditable="false">&lt;!doctype html&gt;
&lt;title&gt;建立 Google Workspace 帳號&lt;/title&gt;
&lt;h2&gt;建立 Google Workspace 帳號&lt;/h2&gt;
&lt;form method="POST"&gt;
  &lt;label&gt;通關密碼：&lt;input type="password" name="secret" required&gt;&lt;/label&gt;&lt;br&gt;
  &lt;label&gt;學號：&lt;input type="text" name="prefix" required&gt;&lt;/label&gt;&lt;br&gt;
&lt;hr&gt;
以下密碼必須符合：&lt;br&gt;
至少 8 個字元&lt;br&gt;
建議包含：&lt;br&gt;
大寫 + 小寫字母&lt;br&gt;
數字&lt;br&gt;
特殊字元（如 !@#$)&lt;br&gt;
&lt;hr&gt;
  &lt;label&gt;新帳號密碼：&lt;input type="password" name="account_password" required&gt;&lt;/label&gt;&lt;br&gt;
  &lt;label&gt;確認密碼：&lt;input type="password" name="confirm_password" required&gt;&lt;/label&gt;&lt;br&gt;
  &lt;input type="submit" value="送出"&gt;
&lt;/form&gt;
{% with messages = get_flashed_messages() %}
  {% if messages %}
    &lt;ul&gt;
    {% for message in messages %}
      &lt;li&gt;{{ message }}&lt;/li&gt;
    {% endfor %}
    &lt;/ul&gt;
  {% endif %}
{% endwith %}
</pre>
<p><br/>2. Flask 應用程式主體<br/><br/>python name=app.py</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">from flask import Flask, render_template, request, redirect, url_for, flash
from google.oauth2 import service_account
from googleapiclient.discovery import build
import os
 
app = Flask(__name__)
app.secret_key = os.urandom(24)
 
# 組態設定
DOMAIN = "your_domain_name"
ADMIN_EMAIL = "your_admin_email"
SERVICE_ACCOUNT_FILE = "C:/your_account_file_directory/service.json"
PASSWORD_SECRET = "your_password_secret"
SCOPES = ['https://www.googleapis.com/auth/admin.directory.user']
 
def create_user(email_prefix, password):
    credentials = service_account.Credentials.from_service_account_file(
        SERVICE_ACCOUNT_FILE, scopes=SCOPES)
    delegated_credentials = credentials.with_subject(ADMIN_EMAIL)
    service = build('admin', 'directory_v1', credentials=delegated_credentials)
    user_body = {
        "primaryEmail": f"{email_prefix}@{DOMAIN}",
        "name": {
            "givenName": email_prefix,
            "familyName": "User"
        },
        "password": password
    }
    user = service.users().insert(body=user_body).execute()
    return user
 
@app.route('/', methods=['GET', 'POST'])
def index():
    if request.method == 'POST':
        secret = request.form['secret']
        prefix = request.form['prefix']
        account_password = request.form['account_password']
        confirm_password = request.form['confirm_password']

        # 權限驗證
        if secret != PASSWORD_SECRET:
            flash("通關密碼錯誤！")
            return redirect(url_for('index'))
        
        if not prefix.isdigit():
            flash("請輸入您的學號")
            return redirect(url_for('index'))
        
        # 密碼確認
        if account_password != confirm_password:
            flash("兩次密碼不一致，請重新確認！")
            return redirect(url_for('index'))
        
        # 密碼驗證（可加入更多規則）
        if len(account_password) &lt; 8:
            flash("密碼長度必須至少 8 個字元！")
            return redirect(url_for('index'))
        
        try:
            result = create_user(prefix, account_password)
            flash(f"帳號建立成功: {result['primaryEmail']}")
        except Exception as e:
            flash(f"建立帳號失敗: {str(e)}")
        return redirect(url_for('index'))
    return render_template('form.html')
 
if __name__ == '__main__':
    app.run(debug=True)
</pre>
<p><br/>3. 進階安全考量建議<br/><br/>- 密碼建議採用強度檢查（可用 Python 密碼強度套件輔助）<br/>- 增加帳號是否已存在的查核（可用 Google Workspace API 查詢帳號）<br/>- 日誌記錄所有操作，便於稽核<br/>- 部署於 HTTPS 環境<br/>- 建議將通關密碼與 API 金鑰資訊寫於環境變數或安全檔案，避免硬編碼<br/><br/>六、操作說明<br/><br/>1. 啟動服務<br/><br/>python app.py<br/><br/>預設於 http://localhost:5000 提供服務。<br/><br/>2. 使用流程<br/><br/>1. 開啟瀏覽器進入應用頁面<br/>2. 輸入通關密碼<br/>3. 輸入欲建立 email 的數字帳號前綴（如 123）<br/>4. 設定對應帳號密碼<br/>5. 按下送出，成功後將顯示建立結果<br/><br/>七、時程規劃（建議）<br/><br/></p>
<table border="1" cellpadding="6" cellspacing="0">
<thead>
<tr>
<th>階段</th>
<th>工作項目</th>
<th>預計工期</th>
</tr>
</thead>
<tbody>
<tr>
<td>需求確認</td>
<td>討論細節與權限</td>
<td>1 天</td>
</tr>
<tr>
<td>環境建置</td>
<td>API/Flask/金鑰設定</td>
<td>1 天</td>
</tr>
<tr>
<td>程式開發</td>
<td>表單與自動化功能撰寫</td>
<td>2 天</td>
</tr>
<tr>
<td>測試驗證</td>
<td>各種狀況測試與修正</td>
<td>1 天</td>
</tr>
<tr>
<td>上線部署</td>
<td>內部伺服器或容器部署</td>
<td>1 天</td>
</tr>
<tr>
<td>文件彙整</td>
<td>操作手冊與維運說明</td>
<td>1 天</td>
</tr>
</tbody>
</table>
<p><br/>八、結論<br/><br/>本專案將顯著提升 IT 人員建立 Google Workspace 帳號的效率與一致性，同時兼顧資訊安全。未來可依需求擴充驗證機制或加入更多自動化管理功能，如帳號停用、密碼重設等。<br/><br/></p>
<br />HTML and CSS << <a href='HTML and CSS.html'>Previous</a> <a href='Waitress.html'>Next</a> >> Waitress</div>
        
    <!-- footer -->
      <div class="container">
        <div class="row pt-3 mx-auto">
            <p>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank" >Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
        </div>
      </div>
    <!-- for footer -->
    
        </div> <!-- for site wrap -->
            <!-- <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script> -->
            <script src="../cmsimde/static/chimper/js/jquery-migrate-3.0.1.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery-ui.js"></script>
            <script src="../cmsimde/static/chimper/js/popper.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap.min.js"></script>
            <script src="../cmsimde/static/chimper/js/owl.carousel.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.stellar.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.countdown.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.magnific-popup.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap-datepicker.min.js"></script>
            <script src="../cmsimde/static/chimper/js/aos.js"></script>
            <!--
            <script src="../cmsimde/static/chimper/js/typed.js"></script>
                    <script>
                    var typed = new Typed('.typed-words', {
                    strings: ["Web Apps"," WordPress"," Mobile Apps"],
                    typeSpeed: 80,
                    backSpeed: 80,
                    backDelay: 4000,
                    startDelay: 1000,
                    loop: true,
                    showCursor: true
                    });
                    </script>
            -->
            <script src="../cmsimde/static/chimper/js/main.js"></script>
        
<!-- 啟用 LaTeX equations 編輯 -->
  <!-- <script>
  MathJax = {
    tex: {inlineMath: [['$', '$'], ['\(', '\)']]}
  };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>-->
    </body></html>
        